/*
 * Copyright (C) 1998, 2000-2007, 2010, 2011, 2012, 2013 SINTEF ICT,
 * Applied Mathematics, Norway.
 *
 * Contact information: E-mail: tor.dokken@sintef.no                      
 * SINTEF ICT, Department of Applied Mathematics,                         
 * P.O. Box 124 Blindern,                                                 
 * 0314 Oslo, Norway.                                                     
 *
 * This file is part of SISL.
 *
 * SISL is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version. 
 *
 * SISL is distributed in the hope that it will be useful,        
 * but WITHOUT ANY WARRANTY; without even the implied warranty of         
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the          
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public
 * License along with SISL. If not, see
 * <http://www.gnu.org/licenses/>.
 *
 * In accordance with Section 7(b) of the GNU Affero General Public
 * License, a covered work must retain the producer line in every data
 * file that is created or manipulated using SISL.
 *
 * Other Usage
 * You can be released from the requirements of the license by purchasing
 * a commercial license. Buying such a license is mandatory as soon as you
 * develop commercial activities involving the SISL library without
 * disclosing the source code of your own applications.
 *
 * This file may be used in accordance with the terms contained in a
 * written agreement between you and SINTEF ICT. 
 */

#include "SislNurbs.h"
#include <iostream>
#include <stdio.h>


using namespace std;

/*
int main()
{
	// pointer to where the point coordinates are stored
	double epoint[1332] = { -676.594712108492, 878.320542128796, -660.052339227136, 861.778169247440, -643.509966345780, 845.235796366085, -626.967593464424, 828.693423484729, -610.425220583068, 812.151050603373, -593.882847701712, 795.608677722017, -577.340474820356, 779.066304840661, -560.798101939000, 762.523931959305, -544.255729057644, 745.981559077949, -527.713356176288, 729.439186196593, -511.170983294932, 712.896813315237, -494.628610413576, 696.354440433881, -478.086237532220, 679.812067552525, -461.543864650865, 663.269694671169, -445.001491769509, 646.727321789813, -428.459118888153, 630.184948908458, -411.916746006797, 613.642576027102, -395.374373125441, 597.100203145746, -378.832000244085, 580.557830264390, -362.289627362729, 564.015457383034, -345.747254481373, 547.473084501678, -329.204881600017, 530.930711620322, -312.662508718661, 514.388338738966, -296.120135837305, 497.845965857610, -279.577762955949, 481.303592976254, -263.035390074593, 464.761220094898, -246.493017193237, 448.218847213542, -229.950644311882, 431.676474332186, -213.408271430526, 415.134101450830, -196.865898549170, 398.591728569474, -180.323525667814, 382.049355688118, -163.781152786458, 365.506982806763, -147.238779905102, 348.964609925407, -130.696407023746, 332.422237044051, -114.154034142390, 315.879864162695, -97.6116612610340, 299.337491281339, -81.0692883796782, 282.795118399983, -64.5269154983222, 266.252745518627, -47.9845426169663, 249.710372637271, -31.4421697356103, 233.167999755915, -14.8997968542545, 216.625626874559, 1.64257602710148, 200.083253993203, 18.1849489084574, 183.540881111847, 34.7273217898135, 166.998508230491, 51.2696946711694, 150.456135349135, 67.8120675525253, 133.913762467780, 84.3544404338812, 117.371389586424, 100.896813315237, 100.829016705068, 117.439186196593, 84.2866438237118, 133.981559077949, 67.7442709423558, 150.523931959305, 51.2018980609998, 167.066304840661, 34.6595251796439, 183.608677722017, 18.1171522982879, 200.151050603373, 1.57477941693196, 216.693423484729, -14.9675934644238, 233.235796366085, -31.5099663457797, 249.778169247440, -48.0523392271357, 266.320542128796, -64.5947121084917, 282.862915010152, -81.1370849898476, 301.954359633204, -97.4427190999916, 323.361520041673, -110.561043870139, 346.557280900008, -120.169042607224, 370.970485593563, -126.030134495222, 396, -128.000000000000, 421.029514406437, -126.030134495222, 445.442719099992, -120.169042607224, 468.638479958328, -110.561043870139, 490.045640366796, -97.4427190999916, 509.137084989848, -81.1370849898476, 525.442719099992, -62.0456403667957, 538.561043870139, -40.6384799583276, 548.169042607225, -17.4427190999916, 554.030134495222, 6.97048559356313, 556, 32, 554.030134495222, 57.0295144064369, 548.169042607225, 81.4427190999916, 538.561043870139, 104.638479958327, 525.442719099992, 126.045640366796, 509.137084989848, 145.137084989848, 491.017612047869, 163.256557931826, 472.898139105891, 181.376030873804, 454.778666163912, 199.495503815783, 436.659193221934, 217.614976757761, 418.539720279956, 235.734449699740, 400.420247337977, 253.853922641718, 382.300774395999, 271.973395583696, 364.181301454021, 290.092868525675, 346.061828512042, 308.212341467653, 327.942355570064, 326.331814409631, 309.822882628086, 344.451287351610, 291.703409686107, 362.570760293588, 273.583936744129, 380.690233235567, 255.464463802150, 398.809706177545, 237.344990860172, 416.929179119523, 219.225517918194, 435.048652061502, 201.106044976215, 453.168125003480, 182.986572034237, 471.287597945458, 164.867099092258, 489.407070887437, 156.751921563286, 498.027958984804, 149.172066005448, 507.123100964806, 142.155190489665, 516.659309640693, 135.726898833738, 526.601788421179, 129.910647176793, 536.914258279422, 124.727658390372, 547.559090131260, 120.196844638480, 558.497442139663, 116.334738369147, 569.689401444380, 113.155431989316, 581.094129799639, 110.670526443182, 592.670012588475, 108.889088881603, 604.374810669957, 107.817619577052, 616.165814505232, 107.460028204822, 628.000000000000, 107.817619577052, 639.834185494768, 108.889088881603, 651.625189330043, 110.670526443182, 663.329987411526, 113.155431989316, 674.905870200361, 116.334738369147, 686.310598555620, 120.196844638480, 697.502557860337, 124.727658390372, 708.440909868740, 129.910647176793, 719.085741720579, 135.726898833738, 729.398211578821, 142.155190489665, 739.340690359307, 149.172066005448, 748.876899035194, 156.751921563286, 757.972041015196, 164.867099092259, 766.592929112563, 173.487987189626, 774.708106641536, 182.583129169627, 782.287962199374, 192.119337845515, 789.304837715157, 202.061816626001, 795.733129371084, 212.374286484243, 801.549381028029, 223.019118336082, 806.732369814450, 233.957470344485, 811.263183566342, 245.149429649202, 815.125289835675, 256.554158004461, 818.304596215506, 268.130040793296, 820.789501761640, 279.834838874779, 822.570939323219, 291.625842710054, 823.642408627770, 303.460028204822, 824, 318.781843822565, 824, 334.103659440309, 824, 349.425475058052, 824, 364.747290675796, 824, 380.069106293539, 824, 395.390921911283, 824, 410.712737529026, 824, 426.034553146770, 824, 441.356368764513, 824, 456.678184382257, 824, 472, 824, 490.844459971206, 823.620451144295, 509.658354159428, 822.482420206810, 528.411166359491, 820.587753077889, 547.072479441432, 817.939522914543, 565.612024687189, 814.542025155781, 583.999730886577, 810.400770555392, 602.205773112900, 805.522476243482, 620.200621099089, 799.915054831264, 637.955087135907, 793.587601576774, 655.440373414515, 786.550379632330, 672.628118736629, 778.814803397659, 689.490444516484, 770.393420005702, 706, 761.299888971117, 722.130006627811, 751.548960034496, 737.854301470181, 741.156449238231, 753.147379663374, 730.139213272838, 767.984435778637, 718.515122135342, 782.341404056692, 706.303030144075, 796.194997442493, 693.522745356905, 809.522745356905, 680.194997442493, 822.303030144075, 666.341404056692, 834.515122135342, 651.984435778637, 846.139213272839, 637.147379663374, 857.156449238231, 621.854301470181, 867.548960034496, 606.130006627811, 877.299888971117, 590, 886.393420005702, 573.490444516484, 894.814803397659, 556.628118736629, 902.550379632330, 539.440373414515, 909.587601576774, 521.955087135907, 915.915054831264, 504.200621099089, 921.522476243482, 486.205773112900, 926.400770555393, 467.999730886577, 930.542025155781, 449.612024687189, 933.939522914543, 431.072479441432, 936.587753077889, 412.411166359491, 938.482420206810, 393.658354159428, 939.620451144295, 374.844459971206, 940, 356, 940, 337.473684210526, 940, 318.947368421053, 940, 300.421052631579, 940, 281.894736842105, 940, 263.368421052632, 940, 244.842105263158, 940, 226.315789473684, 940, 207.789473684210, 940, 189.263157894737, 940, 170.736842105263, 940, 152.210526315790, 940, 133.684210526316, 940, 115.157894736842, 940, 96.6315789473683, 940, 78.1052631578948, 940, 59.5789473684210, 940, 41.0526315789473, 940, 22.5263157894738, 940, 4, 939.652545330240, -16.3481016708370, 938.610586437562, -36.6724783653439, 934.610352395255, -56.7165851687844, 929.937392452626, -76.5352408900939, 924.602426007658, -96.1059708470434, 918.616919644696, -115.406769014336, 911.993067648027, -134.416122734231, 904.743771702906, -153.113036643626, 896.882619814787, -171.477055791078, 888.423864478376, -189.488287918362, 879.382400128949, -207.127424882444, 869.773739909126, -224.375763194938, 859.613991785047, -241.215223657422, 848.919834046545, -257.628370072220, 837.708490226550, -273.598427009629, 825.997703475548, -289.109296613835, 813.805710427416, -304.145574431156, 801.151214593474, -318.692564245568, 788.053359321996, -332.736291907879, 774.531700360810, -346.263518146257, 760.606178060945, -359.261750347263, 746.297089259558, -371.719253297899, 731.625058880601, -383.625058880601, 716.611011291857, -394.968974714538, 701.276141457106, -405.741591737964, 685.641885922233, -415.934290727802, 669.729893674141, -425.539247754051, 653.561996911261, -434.549438568005, 637.160181764405, -442.958641924703, 620.546559006552, -450.761441841390, 603.743334789974, -457.953228795203, 586.772781448900, -464.530199864638, 569.657208405590, -470.489357820730, 552.418933217409, -475.828509175253, 535.080252802075, -480.546261194549, 517.663414877840, -484.642017888942, 500.190589654906, -488.115974988973, 482.683841813823, -490.969113920995, 465.165102806091, -493.203194795894, 447.656143511554, -494.820748425966, 430.178547286540, -495.825067386162, 412.753683435982, -496.220196137113, 395.402681142064, -496.010920228487, 378.146403881116, -495.202754602355, 361.005424359706, -493.801931017342, 344, -491.815384615385, 327.150049003602, -489.250739653952, 310.475127022144, -486.116294427574, 293.994404461944, -482.421005403472, 277.726644449095, -478.174470597005, 261.690181480267, -473.386912213525, 245.902900783546, -468.069158584062, 230.382218412471, -462.232625423086, 215.145062095405, -455.889296437309, 200.207852861204, -449.051703315236, 185.586487461023, -441.732905127838, 171.296321604930, -433.946467171349, 157.352154030804, -425.706439283755, 143.768211421791, -417.027333667118, 130.558134187375, -407.924102248339, 117.734963121878, -398.412113611428, 105.311126952953, -388.507129534741, 93.2984307913883, -378.225281167015, 81.7080454922473, -367.583044876319, 70.5504979361152, -356.597217806312, 59.8356622379244, -345.284893174415, 49.5727518895484, -333.663435346658, 38.2161918380430, -323.414511996600, 27.2161620284267, -312.783837971573, 10.9552674477510, -295.718902883791, -6.10966764003126, -278.653967796009, -23.1746027278135, -261.589032708226, -40.2395378155958, -244.524097620444, -57.3044729033780, -227.459162532662, -74.3694079911603, -210.394227444880, -91.4343430789426, -193.329292357097, -108.499278166725, -176.264357269315, -125.564213254507, -159.199422181533, -142.629148342289, -142.134487093751, -159.694083430072, -125.069552005968, -176.759018517854, -108.004616918186, -193.823953605636, -90.9396818304038, -210.888888693418, -73.8747467426216, -227.953823781201, -56.8098116548392, -245.018758868983, -39.7448765670569, -262.083693956765, -22.6799414792746, -279.148629044548, -5.61500639149244, -296.213564132330, 11.4499286962899, -313.278499220112, 28.5148637840722, -330.343434307894, 45.5797988718544, -347.408369395677, 62.6447339596367, -364.473304483459, 79.7096690474190, -381.538239571241, 96.7746041352012, -398.603174659023, 113.839539222983, -415.668109746806, 130.904474310766, -432.733044834588, 147.969409398548, -449.797979922370, 165.034344486330, -466.862915010152, 182.099279574113, -485.954359633204, 198.404913684256, -507.361520041673, 211.523238454404, -530.557280900008, 221.131237191489, -554.970485593563, 226.992329079487, -580, 228.962194584265, -605.029514406437, 226.992329079487, -629.442719099992, 221.131237191489, -652.638479958328, 211.523238454404, -674.045640366796, 198.404913684256, -693.137084989848, 182.099279574112, -709.442719099992, 163.007834951061, -722.561043870139, 141.600674542592, -732.169042607225, 118.404913684256, -738.030134495222, 93.9917089907017, -740, 68.9621945842648, -740, 44.1140848550515, -740, 19.2659751258384, -740, -5.58213460337493, -740, -30.4302443325882, -740, -55.2783540618013, -740, -80.1264637910147, -740, -104.974573520228, -740, -129.822683249441, -740, -154.670792978654, -740, -179.518902707868, -740, -204.367012437081, -740, -229.215122166294, -740, -254.063231895507, -740, -278.911341624721, -740, -303.759451353934, -740, -328.607561083147, -740, -353.455670812360, -740, -378.303780541574, -740, -403.151890270787, -740, -428, -738.566383855659, -453.527900551554, -734.283563977456, -478.734772942040, -727.205399310308, -503.303626125778, -717.420901881752, -526.925492518803, -705.053117424049, -549.303313445497, -690.257578002711, -570.155674823791, -673.220346110533, -589.220346110533, -654.155674823791, -606.257578002711, -633.303313445497, -621.053117424049, -610.925492518803, -633.420901881751, -587.303626125778, -643.205399310308, -562.734772942040, -650.283563977456, -537.527900551554, -654.566383855659, -512, -656, -488.000000000000, -656, -475.125349005324, -656.518830698527, -462.334195062758, -658.071957977934, -449.709493713991, -660.649309211832, -437.333120991764, -664.234169288457, -425.285342422388, -668.803289014588, -413.644292472997, -674.327035895486, -402.485467819552, -680.769586312993, -391.881237721923, -688.089157855440, -381.900374681473, -696.238280292624, -372.607608424990, -705.164103438464, -364.063206107575, -714.808739904740, -356.322581457015, -725.109640523015, -349.435935394490, -736, -343.447930462339, -747.409190175511, -338.397401170334, -759.263218073194, -334.317102138980, -771.485205773368, -331.233495673237, -783.995888995833, -329.166580144311, -796.714131159148, -328.129760292549, -809.557449582493, -328.129760292549, -822.442550417507, -329.166580144311, -835.285868840852, -331.233495673237, -848.004111004167, -334.317102138980, -860.514794226633, -338.397401170334, -872.736781926806, -343.447930462339, -884.590809824489, -349.435935394490, -896.000000000000, -356.322581457015, -906.890359476985, -364.063206107575, -917.191260095261, -372.607608424990, -926.835896561536, -381.900374681473, -935.761719707376, -391.881237721923, -943.910842144560, -402.485467819552, -951.230413687007, -413.644292472997, -957.672964104514, -425.285342422388, -963.196710985412, -437.333120991764, -967.765830711543, -449.709493713991, -971.350690788168, -462.334195062758, -973.928042022066, -475.125349005324, -975.481169301473, -488, -976, -503.333333333333, -976, -518.666666666667, -976, -534, -976, -549.333333333333, -976, -564.666666666667, -976, -580, -976, -606.906727986920, -978.117605417636, -633.150923032491, -984.418279197234, -658.086365955202, -994.746877839601, -681.099063394305, -1008.84907696751, -701.622366364086, -1026.37763363591, -719.150923032491, -1046.90093660569, -733.253122160399, -1069.91363404480, -743.581720802766, -1094.84907696751, -749.882394582364, -1121.09327201308, -752, -1148, -749.882394582364, -1174.90672798692, -743.581720802766, -1201.15092303249, -733.253122160399, -1226.08636595520, -719.150923032491, -1249.09906339431, -701.622366364086, -1269.62236636409, -681.099063394305, -1287.15092303249, -658.086365955202, -1301.25312216040, -633.150923032491, -1311.58172080277, -606.906727986920, -1317.88239458236, -580, -1320, -553.920000000000, -1320, -527.840000000000, -1320, -501.760000000000, -1320, -475.680000000000, -1320, -449.600000000000, -1320, -423.520000000000, -1320, -397.440000000000, -1320, -371.360000000000, -1320, -345.280000000000, -1320, -319.200000000000, -1320, -293.120000000000, -1320, -267.040000000000, -1320, -240.960000000000, -1320, -214.880000000000, -1320, -188.800000000000, -1320, -162.720000000000, -1320, -136.640000000000, -1320, -110.560000000000, -1320, -84.4800000000000, -1320, -58.4000000000000, -1320, -32.3199999999999, -1320, -6.24000000000001, -1320, 19.8400000000000, -1320, 45.9200000000000, -1320, 72, -1320, 99.7837084267089, -1317.56924048195, 126.723222932107, -1310.35081932575, 152, -1298.56406460551, 174.846017549846, -1282.56711089904, 194.567110899037, -1262.84601754985, 210.564064605510, -1240, 222.350819325745, -1214.72322293211, 229.569240481953, -1187.78370842671, 232.000000000000, -1160, 232.937926855303, -1142.70095705217, 234.107756393356, -1134.11488055156, 235.740711086386, -1125.60472956624, 237.832001196924, -1117.19546583532, 240.375492610752, -1108.91175517824, 243.363724829313, -1100.77789514561, 246.787932852647, -1092.81774375036, 250.638072888636, -1085.05464948803, 254.902851813186, -1077.51138285168, 259.569760294898, -1070.21006954202, 264.625109487097, -1063.17212556900, 270.054071179578, -1056.41819443491, 275.840721292299, -1049.96808658345, 281.968086583452, -1043.84072129230, 288.418194434908, -1038.05407117958, 295.172125568998, -1032.62510948710, 302.210069542019, -1027.56976029490, 309.511382851677, -1022.90285181319, 317.054649488034, -1018.63807288864, 324.817743750358, -1014.78793285265, 332.777895145614, -1011.36372482931, 340.911755178243, -1008.37549261075, 349.195465835325, -1005.83200119692, 357.604729566236, -1003.74071108639, 366.114880551558, -1002.10775639336, 374.700957052169, -1000.93792685530, 383.337774626333, -1000.23465378382, 392, -1000, 408.941176470588, -1000, 425.882352941177, -1000, 442.823529411765, -1000, 459.764705882353, -1000, 476.705882352941, -1000, 493.647058823530, -1000, 510.588235294118, -1000, 527.529411764706, -1000, 544.470588235294, -1000, 561.411764705882, -1000, 578.352941176471, -1000, 595.294117647059, -1000, 612.235294117647, -1000, 629.176470588235, -1000, 646.117647058823, -1000, 663.058823529412, -1000, 680, -1000, 706.346109968663, -999.425125835442, 732.642068619586, -997.701597647414, 758.837820100911, -994.832696269781, 784.883499310826, -990.823882819374, 810.729526818614, -985.682788300440, 836.326703241923, -979.419199078597, 861.626302900581, -972.045038251929, 886.580166568704, -963.574342954689, 911.140793148514, -954.023237636817, 935.261430091382, -943.409903370137, 958.896162393961, -931.754543239646, 982, -919.079343885801, 1004.52896344148, -905.408433270983, 1026.44016755603, -890.767834750551, 1047.69190312127, -875.185417535906, 1068.24371625067, -858.690843643863, 1088.05648539986, -841.315511433315, 1107.09249583667, -823.092495836675, 1125.31551143332, -804.056485399859, 1142.69084364386, -784.243716250670, 1159.18541753591, -763.691903121267, 1174.76783475055, -742.440167556032, 1189.40843327098, -720.528963441482, 1203.07934388580, -698, 1215.75454323965, -674.896162393961, 1227.40990337014, -651.261430091382, 1238.02323763682, -627.140793148514, 1247.57434295469, -602.580166568704, 1256.04503825193, -577.626302900581, 1263.41919907860, -552.326703241923, 1269.68278830044, -526.729526818614, 1274.82388281937, -500.883499310826, 1278.83269626978, -474.837820100911, 1281.70159764741, -448.642068619586, 1283.42512583544, -422.346109968663, 1284, -396, 1284, -370.133333333333, 1284, -344.266666666667, 1284, -318.400000000000, 1284, -292.533333333333, 1284, -266.666666666667, 1284, -240.800000000000, 1284, -214.933333333333, 1284, -189.066666666667, 1284, -163.200000000000, 1284, -137.333333333333, 1284, -111.466666666667, 1284, -85.5999999999999, 1284, -59.7333333333334, 1284, -33.8666666666668, 1284, -8, 1284, 17.8666666666668, 1284, 43.7333333333334, 1284, 69.5999999999999, 1284, 95.4666666666667, 1284, 121.333333333333, 1284, 147.200000000000, 1284, 173.066666666667, 1284, 198.933333333333, 1284, 224.800000000000, 1284, 250.666666666667, 1284, 276.533333333333, 1284, 302.400000000000, 1284, 328.266666666667, 1284, 354.133333333333, 1284, 380.000000000000, 1283.55995221944, 406.331001882048, 1282.24030035504, 432.632595391156, 1280.04251828974, 458.875404999790, 1276.96906066597, 485.030120834538, 1273.02336014414, 511.067531411506, 1268.20982356883, 536.958556261823, 1262.53382704685, 562.674278410812, 1256.00170994285, 588.185976674573, 1248.62076779905, 613.465157737880, 1240.39924418704, 638.483587977580, 1231.34632150078, 663.213324995960, 1221.47211070103, 687.626748828834, 1210.78764002266, 711.696592793528, 1199.30484265759, 735.395973942288, 1187.03654342686, 758.698423087107, 1173.99644445699, 781.577914362431, 1160.19910987644, 804.008894292738, 1145.65994954931, 825.966310332509, 1130.39520186452, 847.425638846732, 1114.42191559958, 868.362912500673, 1097.75793087930, 888.754747028336, 1080.42185925059, 908.578367349708, 1062.43306289581, 927.811633007618, 1043.81163300762, 946.433062895808, 1024.57836734971, 964.421859250590, 1004.75474702834, 981.757930879298, 984.362912500673, 998.421915599585, 963.425638846732, 1014.39520186452, 941.966310332509, 1029.65994954931, 920.008894292738, 1044.19910987644, 897.577914362431, 1057.99644445699, 874.698423087107, 1071.03654342686, 851.395973942288, 1083.30484265759, 827.696592793528, 1094.78764002266, 803.626748828834, 1105.47211070103, 779.213324995960, 1115.34632150078, 754.483587977581, 1124.39924418704, 729.465157737880, 1132.62076779905, 704.185976674574, 1140.00170994285, 678.674278410812, 1146.53382704685, 652.958556261823, 1152.20982356883, 627.067531411507, 1157.02336014414, 601.030120834538, 1160.96906066597, 574.875404999790, 1164.04251828974, 548.632595391156, 1166.24030035504, 522.331001882048, 1167.55995221944, 496.000000000000, 1168, 469.100000000000, 1168, 442.200000000000, 1168, 415.300000000000, 1168, 388.400000000000, 1168, 361.500000000000, 1168, 334.600000000000, 1168, 307.700000000000, 1168, 280.800000000000, 1168, 253.900000000000, 1168, 227, 1168, 200.100000000000, 1168, 173.200000000000, 1168, 146.300000000000, 1168, 119.400000000000, 1168, 92.5000000000000, 1168, 65.6000000000000, 1168, 38.7000000000000, 1168, 11.8000000000000, 1168, -15.1000000000000, 1168, -42, 1168, -68.9000000000000, 1168, -95.8000000000000, 1168, -122.700000000000, 1168, -149.600000000000, 1168, -176.500000000000, 1168, -203.400000000000, 1168, -230.300000000000, 1168, -257.200000000000, 1168, -284.100000000000, 1168, -311, 1168, -337.900000000000, 1168, -364.800000000000, 1168, -391.700000000000, 1168, -418.600000000000, 1168, -445.500000000000, 1168, -472.400000000000, 1168, -499.300000000000, 1168, -526.200000000000, 1168, -553.100000000000, 1168, -580, 1168, -605.029514406437, 1166.03013449522, -629.442719099992, 1160.16904260722, -652.638479958328, 1150.56104387014, -674.045640366796, 1137.44271909999, -693.137084989848, 1121.13708498985, -709.442719099992, 1102.04564036680, -722.561043870139, 1080.63847995833, -732.169042607225, 1057.44271909999, -738.030134495222, 1033.02951440644, -740, 1008, -738.030134495222, 982.970485593563, -732.169042607225, 958.557280900008, -722.561043870139, 935.361520041672, -709.442719099992, 913.954359633204, -693.137084989848, 894.862915010152 };
	int inbpnt = 666; // number of points to be interpolated
	int idim = 2; // the dimension
	int nptyp[666]; // what type of information is stored at a particular point
	int icnsta = 0; // no additional condition at start point
	int icnend = 0; // no additional condition at end point
	int iopen = -1; // periodic close
	int ik = 2; // order of the spline curve to be produced
	double astpar = 0.0; // parameter value to be used at start of curve
	double cendpar = 0.0; // parameter value at the end of the curve (to be determined)
	SISLCurve *result_curve = NULL; // the resulting spline curve (to be determined)
	double *gpar = NULL; // pointer to the parameter values of the points in the curve(to be determined)
	int jnbpar = 0; // number of unique parameter values (to be determined)
	int jstat; // status message

	// Define all ordinary points
	for(int i = 0; i < inbpnt; ++i)
	{
		nptyp[i] = 1;
	}

	s1356(epoint, inbpnt, idim, nptyp, icnsta, icnend, iopen, ik, astpar,
		&cendpar, &result_curve, &gpar, &jnbpar, &jstat);

	// Find position and its derivates for a given parameter curve input
	int temp, jstat1;
	double parvalue = 0;// result_curve->et[result_curve->in]; //end parameter
	double positon[4];

	s1227(result_curve,          // input curve
		1,           // evaluate position and derivatives
		parvalue,   // input parameter
		&temp,       // indicates param. interval (not interesting for our purposes)
		positon, // this is what we want to calculate (3D position)
		&jstat1);     // status variable (0 if everything all right)

	printf("Error %d Pos %lf %lf Right Deriv %lf %lf  \n", jstat1, positon[0], positon[1], positon[2], positon[3]);

	s1221(result_curve,          // input curve
		1,           // evaluate position and derivatives
		parvalue,   // input parameter
		&temp,       // indicates param. interval (not interesting for our purposes)
		positon, // this is what we want to calculate (3D position)
		&jstat1);     // status variable (0 if everything all right)

	printf("Error %d Pos %lf %lf Right Deriv %lf %lf  \n", jstat1, positon[0], positon[1], positon[2], positon[3]);


	// Closest point
	double point[2] = { -675.5, 878.3 };
	double aepsco = 1e-8;
	double aepsge = 1e-8;
	double param;
	double dist;
	int jstat3;

	s1957(result_curve, point, idim, aepsco, aepsge, &param, &dist, &jstat3);

	printf("Error %d Param %lf dist %lf \n", jstat3, param, dist);



	double point2[2] = { -675.5, 878.3 };
	double epsco = 1e-5;
	double epsge = 1e-5;
	int numintpt;
	double *intpar;
	int numintcu;
	SISLIntcurve **intcurve;
	int jstat4;
	
	s1953(result_curve, point2, idim, epsco, epsge, &numintpt, &intpar, &numintcu, &intcurve, &jstat4);

	printf("Error %d Npoints %d First point param %lf \n", jstat4, numintpt, intpar[0]);

	// cleaning up
	freeCurve(result_curve);
	free(gpar);

}
*/

SISLCurve* createNURBS(double epoint[], int nptyp[], int num_points)
{
	const int inbpnt = num_points; // number of points to be interpolated
	int idim = 2; // the dimension
	int icnsta = 0; // no additional condition at start point
	int icnend = 0; // no additional condition at end point
	int iopen = -1; // periodic close
	int ik = 3; // order of the spline curve to be produced
	double astpar = 0.0; // parameter value to be used at start of curve
	double cendpar = 0.0; // parameter value at the end of the curve (to be determined)
	SISLCurve *result_curve = NULL; // the resulting spline curve (to be determined)
	double *gpar = NULL; // pointer to the parameter values of the points in the curve(to be determined)
	int jnbpar = 0; // number of unique parameter values (to be determined)
	int jstat; // status message

	s1356(epoint, inbpnt, idim, nptyp, icnsta, icnend, iopen, ik, astpar,
		&cendpar, &result_curve, &gpar, &jnbpar, &jstat);

	return result_curve;

}

double* interrogateNURBS(SISLCurve *Curve, double param, double position[4])
{
	// Find position and its derivates for a given parameter curve input
	int temp, jstat1;
	double parvalue = param;// result_curve->et[result_curve->in]; //end parameter

	s1227(Curve,          // input curve
		0,           // evaluate position and derivatives
		parvalue,   // input parameter
		&temp,       // indicates param. interval (not interesting for our purposes)
		position, // this is what we want to calculate (3D position)
		&jstat1);     // status variable (0 if everything all right)

	return position;
}


double* closestpoint(SISLCurve *Curve, double point[2], double output[2])
{
	// Closest point
	double aepsco = 1e-8;
	double aepsge = 1e-8;
	double param;
	double dist;
	int jstat3;

	s1957(Curve, point, 2, aepsco, aepsge, &param, &dist, &jstat3);

	output[0] = param;
	output[1] = dist;
	return output;
}


double CalculateDerivate(SISLCurve *Curve, double param)
{
	int temp1, jstat1, temp2, jstat2;
	double position1[2];
	double position2[2];

	s1227(Curve,          // input curve
		0,           // evaluate position and derivatives
		param,   // input parameter
		&temp1,       // indicates param. interval (not interesting for our purposes)
		position1, // this is what we want to calculate (3D position)
		&jstat1);     // status variable (0 if everything all right)
	double param2 = param + 0.01;

	s1227(Curve,          // input curve
		0,           // evaluate position and derivatives
		param2,   // input parameter
		&temp2,       // indicates param. interval (not interesting for our purposes)
		position2, // this is what we want to calculate (3D position)
		&jstat2);     // status variable (0 if everything all right)

	return atan2((position2[1] - position1[1]) , (position2[0] - position1[0]));
}

void freeNURBS(SISLCurve *Curve)
{
	// cleaning up
	freeCurve(Curve);
}